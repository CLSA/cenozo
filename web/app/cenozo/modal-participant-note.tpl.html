<form ng-submit="ok()" novalidate name="form" class="noselect">
  <div class="modal-header">
    <button type="button" class="close" ng-click="close()">&times;</button>
    <h4 class="modal-title">Notes for {{ participant.uid }}</h4>
  </div>
  <div class="modal-body">
    <p class="text-info">
      Participant notes are listed from most recent to least recent, with "sticky" notes
      always showing at the top.
    </p>
    <hr />
    <div class="panel panel-default" ng-repeat="note in noteList | orderBy:'-sticky'">
      <div class="panel-heading">
        <span>{{ note.userFirst }} {{ note.userLast }}</span>
        <span class="pull-right">
          {{ note.datetime | cnDatetime:'datetimesecond' }}
          <button ng-if="allowEdit"
                  class="btn btn-xs btn-default"
                  ng-class="{'btn-warning':note.sticky}"
                  ng-click="stickyChanged( note.id )">
            <i class="glyphicon glyphicon-pushpin"></i>
          </button>
          <button ng-if="allowDelete"
                  class="btn btn-xs btn-danger"
                  cn-really-message="Are you sure you want to delete the note by {{ note.userFirst }} {{ note.userLast }}?"
                  cn-really-click="deleteNote( note.id )">
            <i class="glyphicon glyphicon-remove"></i>
          </button>
        </span>
      </div>
      <div style="position:relative;">
        <textarea id="note{{ note.id }}"
                  ng-model="note.note"
                  cn-change="noteChanged( note.id )"
                  class="form-control note"
                  ng-disabled="!allowEdit"
                  cn-elastic></textarea>
        <button ng-if="!note.added && note.note != note.noteBackup"
                class="btn btn-warning"
                style="position:absolute;bottom:0px;right:0px;"
                ng-click="undo( note.id )">undo</button>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button ng-if="allowAdd" type="button" class="btn btn-default" ng-click="addNote()">
      Add <i class="glyphicon glyphicon-plus"></i>
    </button>
    <button type="button" class="btn btn-primary" ng-click="close()">Close</button>
  </div>
</form>
